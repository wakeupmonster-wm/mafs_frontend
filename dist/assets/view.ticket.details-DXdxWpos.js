import{b6 as A,i as L,A as I,r as c,aI as D,j as e,ar as m,aP as y,F as E,C as o,m as N,n as b,J as B,B as U,p as x,E as S,ae as g,M as _,aL as F,aK as M}from"./index-Cah9GgNi.js";import{T as z}from"./textarea-BdgJi3SO.js";import{S as P,a as V,b as q,c as O,d as i}from"./select-DxUcbfzd.js";import{C as d}from"./clock-BveIEetd.js";import{U as G}from"./user-D1L96pnc.js";import{R as v}from"./reply-D8OrzNJ1.js";import{L as k}from"./loader-circle-D_OERo1u.js";import{S as H}from"./send-wUGRbl-K.js";import{T as J}from"./tag-DgavYqPe.js";import{C}from"./circle-alert-CnaEjTQV.js";import{T as K}from"./ticket-2ZcPdQmn.js";const w={open:{color:"bg-blue-50 text-blue-700 border-blue-200",icon:d},in_progress:{color:"bg-amber-50 text-amber-700 border-amber-200",icon:d},resolved:{color:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:m},closed:{color:"bg-slate-50 text-slate-700 border-slate-200",icon:m}};function de(){const{ticketId:t}=A(),l=L(),{selectedTicket:s,loading:n,error:h,successMessage:p}=I(a=>a.support),[r,j]=c.useState(""),[u,f]=c.useState("");c.useEffect(()=>{t&&l(D(t))},[l,t]),c.useEffect(()=>{s&&f(s.status)},[s]);const T=async a=>{a.preventDefault(),r.trim()&&l(F({ticketId:t,reply:r,status:u})).then(()=>{j(""),setTimeout(()=>l(M()),3e3)})};if(n&&!s)return e.jsx(Q,{});if(h)return e.jsx($,{message:h});if(!s)return e.jsx(W,{});const R=w[s.status]?.icon||d;return e.jsx("div",{className:"min-h-screen bg-[#f8fafc] p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(y,{to:"/admin/management/support/tickets",className:"group flex items-center gap-2 text-sm text-slate-500 hover:text-slate-900 transition-all",children:[e.jsx(E,{className:"w-4 h-4 transition-transform group-hover:-translate-x-1"}),"Back to Ticket List"]}),e.jsxs("div",{className:"text-xs text-slate-400 font-mono",children:["ID: ",s._id]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(o,{className:"border-none shadow-sm overflow-hidden",children:[e.jsx(N,{className:"bg-white border-b border-slate-100",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(b,{className:"text-xl font-bold text-slate-900",children:s.subject}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(B,{className:"w-3.5 h-3.5"}),new Date(s.createdAt).toLocaleString()]})]}),e.jsxs(U,{className:`${w[s.status]?.color} capitalize px-3 py-1`,children:[e.jsx(R,{className:"w-3 h-3 mr-1.5"}),s.status.replace("_"," ")]})]})}),e.jsxs(x,{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 border border-slate-200",children:e.jsx(G,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900",children:"Customer"}),e.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-widest font-bold",children:"Initial Request"})]}),e.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl rounded-tl-none p-4 text-slate-700 text-sm leading-relaxed shadow-sm",children:s.message})]})]}),s.adminReply&&e.jsxs("div",{className:"flex gap-4 flex-row-reverse",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 border border-emerald-200",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 space-y-2 text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("span",{className:"text-[10px] text-emerald-500 uppercase tracking-widest font-bold",children:"Admin Response"}),e.jsx("span",{className:"text-sm font-bold text-emerald-900",children:"Support Team"})]}),e.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 rounded-2xl rounded-tr-none p-4 text-emerald-800 text-sm leading-relaxed shadow-sm inline-block text-left min-w-[60%]",children:[s.adminReply,s.repliedAt&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-100 text-[10px] text-emerald-600/70",children:["Sent on"," ",new Date(s.repliedAt).toLocaleString()]})]})]})]})]})]}),s.status!=="closed"&&e.jsx(o,{className:"border-none shadow-md overflow-hidden ring-1 ring-slate-200",children:e.jsxs("form",{onSubmit:T,children:[e.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100 flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-slate-400"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Quick Response"})]}),e.jsxs(x,{className:"p-6 space-y-4",children:[e.jsx(z,{rows:4,value:r,onChange:a=>j(a.target.value),placeholder:"Address the customer's issue clearly...",className:"border-slate-200 focus:ring-slate-900 focus:border-slate-900 resize-none shadow-inner"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 w-full space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider ml-1",children:"Change Ticket Status"}),e.jsxs(P,{value:u,onValueChange:f,children:[e.jsx(V,{className:"bg-white border-slate-200",children:e.jsx(q,{})}),e.jsxs(O,{children:[e.jsx(i,{value:"open",children:"Open"}),e.jsx(i,{value:"in_progress",children:"In Progress"}),e.jsx(i,{value:"resolved",children:"Resolved"}),e.jsx(i,{value:"closed",children:"Closed"})]})]})]}),e.jsxs(S,{type:"submit",disabled:n||!r.trim(),className:"bg-slate-900 text-white hover:bg-black px-8 h-10 shadow-lg shadow-slate-200",children:[n?e.jsx(k,{className:"animate-spin w-4 h-4"}):e.jsx(H,{className:"w-4 h-4 mr-2"}),"Send Reply"]})]})]})]})}),p&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-600 bg-emerald-50 p-3 rounded-lg border border-emerald-100 animate-in fade-in slide-in-from-bottom-2",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:p})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{className:"border-none shadow-sm",children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-sm font-bold text-slate-400 uppercase tracking-widest",children:"Metadata"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Category"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:s.category})]})]}),e.jsx(g,{className:"bg-slate-100"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"User Association"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm font-mono text-slate-600 truncate",children:s.userId})]})]}),e.jsx(g,{className:"bg-slate-100"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Last Updated"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-600 text-sm",children:[e.jsx(d,{className:"w-4 h-4 text-slate-400"}),new Date(s.updatedAt).toLocaleDateString()]})]})]})]}),s.status==="closed"&&e.jsxs("div",{className:"p-4 bg-slate-100 rounded-xl border border-slate-200 text-center space-y-2",children:[e.jsx(C,{className:"w-5 h-5 text-slate-400 mx-auto"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"This ticket is archived. Re-open to send new replies."})]})]})]})]})})}const Q=()=>e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center gap-4 bg-slate-50",children:[e.jsx(k,{className:"w-10 h-10 text-slate-300 animate-spin"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Synchronizing ticket data..."})]}),$=({message:t})=>e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-6 rounded-2xl shadow-sm border border-red-100 text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto",children:e.jsx(C,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Fetch Failed"}),e.jsx("p",{className:"text-slate-500 text-sm",children:t}),e.jsx(S,{variant:"outline",onClick:()=>window.location.reload(),children:"Retry Request"})]})}),W=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(K,{className:"w-16 h-16 text-slate-200 mx-auto"}),e.jsx("p",{className:"text-slate-400 font-medium",children:"Ticket entry not found."}),e.jsx(y,{to:"/admin/management/support/tickets",className:"text-slate-900 underline font-semibold",children:"Return to Dashboard"})]})});export{de as default};
