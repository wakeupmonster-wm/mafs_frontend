import{b6 as W,i as z,s as B,A as $,r as k,cx as V,cy as L,j as e,z as O,E as G,F as _,Q as J,T as K,O as A,U as Q,ar as Y,a as d,B as i,M as T,P as C,cz as Z,cA as I,co as X,cu as ee,C as m,m as j,n as u,S as se,p as h,ae as D,J as ae,V as te,ah as w,a2 as P,a3 as S,a4 as g,a5 as r,a6 as M,a7 as l,cB as re,N as E}from"./index-Cah9GgNi.js";import{D as le,a as ie,b as ne}from"./dialog-CgcypPnB.js";import{I as oe,A as de}from"./index-Dq74rUHN.js";import{C as q}from"./copy-D_bSaBc8.js";import{G as ce}from"./globe-COnuhVpK.js";function je(){const{userId:o}=W(),n=z(),c=B(),{userData:s,loading:p}=$(a=>a.subscription);k.useEffect(()=>(o&&n(V(o)),()=>n(L())),[n,o]);const{transactions:x,events:v,summary:b,user:t}=s||{},y=k.useMemo(()=>{if(!s?.startedAt||!s?.expiresAt)return 0;const a=new Date(s.expiresAt)-new Date(s.startedAt),U=new Date-new Date(s.startedAt);return Math.min(100,Math.max(0,U/a*100))},[s]),R=()=>{navigator.clipboard.writeText(t?.email),E.success("Email copied",{id:"email-copy"})},F=()=>{navigator.clipboard.writeText(t?.phone),E.success("Phone copied",{id:"phone-copy"})},H=s?.platform==="ios"?oe:de;return e.jsx("div",{className:"p-4 bg-[#f8fafc] min-h-screen pb-20",children:e.jsxs(O.div,{initial:{opacity:0},animate:{opacity:1},className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex-1 flex-col items-start space-y-3",children:[e.jsxs(G,{variant:"ghost",onClick:()=>c(-1),className:"hover:bg-slate-100 group",children:[e.jsx(_,{className:"mr-2 h-4 w-4 transition-transform group-hover:-translate-x-1"}),"Back to Analytics"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between px-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start md:items-center",children:[e.jsxs(le,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsxs(J,{className:"h-20 w-20 border-4 border-white shadow-xl ",children:[e.jsx(K,{src:t?.avatar?.url||A,alt:t?.nickname}),e.jsx(Q,{className:"bg-indigo-100 text-indigo-700 text-2xl font-bold",children:t?.nickname})]}),e.jsx("div",{className:d("absolute bottom-0 right-1 p-1 rounded-full border-2 border-white shadow-lg",s?.status==="ACTIVE"?"bg-emerald-500":"bg-slate-400"),children:e.jsx(Y,{className:"w-3 h-3 text-white"})})]})}),e.jsx(ne,{className:"max-w-md border-none bg-transparent shadow-none p-0",children:e.jsx("img",{src:t?.avatar?.url||A,alt:t?.nickname,className:"w-full rounded-2xl shadow-2xl"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 capitalize tracking-tight",children:t?.nickname||"Unknown User"}),e.jsxs(i,{variant:"secondary",className:d("flex items-center gap-1.5 px-3 py-1 font-bold shadow-sm ring-1 ring-inset",s?.platform==="ios"?"bg-slate-900 text-white ring-slate-800":"bg-emerald-50 text-emerald-700 ring-emerald-100"),children:[e.jsx(H,{className:d("w-3.5 h-3.5",s?.platform==="ios"?"text-white":"text-emerald-600")}),s?.platform==="ios"?"IOS":"Android"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-slate-500 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-2 font-medium text-slate-700 cursor-pointer truncate group w-max",children:[e.jsx(T,{className:"w-3.5 h-3.5"})," ",t?.email,e.jsx(q,{onClick:R,title:"Copy Email",className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-aqua"})]}),e.jsxs("span",{className:"flex items-center gap-2 font-medium text-slate-700 cursor-pointer truncate group w-max",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),t?.phone,e.jsx(q,{onClick:F,title:"Copy Phone",className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-aqua"})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-amber-200/20 via-amber-400/10 to-amber-50 px-6 py-3 rounded-xl border border-slate-100 shadow-md",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest mb-1",children:"Environment"}),e.jsx(i,{className:d("font-black uppercase text-xs tracking-tighter",s?.environment==="sandbox"?"bg-amber-100 text-amber-700 hover:bg-amber-100":"bg-indigo-600 text-white"),children:s?.environment})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-200/20 via-emerald-400/10 to-emerald-50 px-6 py-3 rounded-xl border border-slate-100 text-center shadow-md",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Current Status"}),e.jsx("p",{className:d("text-sm font-black",s?.status==="ACTIVE"?"text-emerald-600":"text-slate-500"),children:s?.status})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(f,{title:"Lifetime Value",value:`$${(b?.totalPaid-b?.totalRefunded).toFixed(2)}`,icon:Z,color:"emerald",description:"Net revenue generated"}),e.jsx(f,{title:"Total Transactions",value:b?.totalTransactions,icon:I,color:"amber",description:"Since first started"}),e.jsx(f,{title:"Days Active",value:b?.daysSinceStart,icon:X,color:"rose",description:"Since first started"}),e.jsx(f,{title:"Auto Renew",value:s?.autoRenew?"Enabled":"Disabled",icon:ee,color:s?.autoRenew?"blue":"slate",description:"Cycle status"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(m,{className:"rounded-xl border hover:border-gray-300 shadow-lg shadow-slate-200",children:[e.jsx(j,{children:e.jsxs(u,{className:"text-base font-bold flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-brand-aqua",strokeWidth:2.5}),"Identity"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsx(N,{label:"Email Address",value:t?.email,icon:T}),e.jsx(N,{label:"Phone Number",value:t?.phone,icon:C}),e.jsx(N,{label:"Platform Source",value:s?.platform,icon:ce,badge:!0}),e.jsx(D,{}),e.jsx(N,{label:"User ID",value:t?.userId,mono:!0})]})]}),e.jsx("div",{className:"lg:col-span-1 space-y-4",children:e.jsxs(m,{className:"rounded-xl border hover:border-gray-300 shadow-lg shadow-slate-200 gap-4",children:[e.jsx(j,{children:e.jsxs(u,{className:"text-base font-black flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-brand-aqua",strokeWidth:2.5})," ","Subscription Cycle"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative pt-2",children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsxs("div",{className:"text-xl font-black",children:[Math.round(y),"%"]}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 text-right uppercase",children:"Progress to Renewal"})]}),e.jsx(te,{value:y,className:"h-2 rounded-full bg-slate-200"})]}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsxs("div",{className:"p-3 text-center bg-slate-50 rounded-2xl border border-slate-100",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Started"}),e.jsx("p",{className:"text-xs font-semibold",children:s?.startedAt?w(new Date(s.startedAt),"MMM dd, yyyy"):"-"})]}),e.jsxs("div",{className:"p-3 bg-slate-50 text-center rounded-2xl border border-slate-100",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Expires"}),e.jsx("p",{className:"text-xs font-semibold",children:s?.expiresAt?w(new Date(s.expiresAt),"MMM dd, yyyy"):"-"})]})]}),e.jsx(D,{className:"opacity-50"}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-400",children:"Offer Type"}),e.jsx("span",{className:"font-bold text-slate-700",children:s?.offerType||"None"})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-400",children:"Family Sharing"}),e.jsx("span",{className:"font-bold text-slate-700",children:s?.isInFamilySharing?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-400",children:"Plan Type"}),e.jsx("span",{className:"font-bold text-slate-700",children:s?.planType||"None"})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-400",children:"Product Id"}),e.jsx("span",{className:"font-bold text-slate-700",children:s?.productId||"None"})]})]})]})})]})})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(m,{className:"rounded-xl border hover:border-gray-300 shadow-lg shadow-slate-200 gap-4",children:[e.jsx(j,{children:e.jsxs(u,{className:"text-base font-bold flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-brand-aqua",strokeWidth:2.5})," ","Transactional History"]})}),e.jsx(h,{children:e.jsxs(P,{children:[e.jsx(S,{children:e.jsxs(g,{children:[e.jsx(r,{children:"Event"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{children:"Txn ID"}),e.jsx(r,{className:"text-right",children:"Date"})]})}),e.jsx(M,{children:x?.map(a=>e.jsxs(g,{className:"text-xs",children:[e.jsx(l,{children:e.jsx(i,{variant:"outline",className:"text-[10px] tracking-tight",children:a.eventType})}),e.jsxs(l,{className:"font-bold text-emerald-600",children:["$",a.amount.toFixed(2)]}),e.jsx(l,{className:"font-mono text-slate-400",children:a.transactionId}),e.jsx(l,{className:"text-right",children:w(new Date(a.occurredAt),"MMM dd, HH:mm")})]},a._id))})]})})]}),e.jsxs(m,{className:"rounded-xl border hover:border-gray-300 shadow-lg shadow-slate-200 gap-4",children:[e.jsx(j,{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(u,{className:"text-base font-bold flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-brand-aqua",strokeWidth:2.5}),"Webhook Lifecycle"]}),e.jsx(i,{className:"bg-brand-aqua/10 text-brand-aqua border-brand-aqua",children:"System Active"})]})}),e.jsx(h,{children:e.jsxs(P,{children:[e.jsx(S,{children:e.jsxs(g,{children:[e.jsx(r,{children:"Event Type"}),e.jsx(r,{children:"Original Txn Id"}),e.jsx(r,{children:"Txn ID"}),e.jsx(r,{children:"Product ID"}),e.jsx(r,{children:"User ID"})]})}),e.jsx(M,{children:v?.map(a=>e.jsxs(g,{className:"text-xs",children:[e.jsx(l,{children:e.jsx(i,{variant:"outline",className:"text-[10px] tracking-tight",children:a.eventType})}),e.jsxs(l,{className:"font-bold text-emerald-600",children:["$",a?.rawPayload?.originalTransactionId]}),e.jsx(l,{children:e.jsx(i,{variant:"outline",className:"text-[12px] font-mono tracking-tight text-gray-600",children:a?.rawPayload?.transactionId})}),e.jsx(l,{children:e.jsx(i,{variant:"outline",className:"text-[12px] font-mono tracking-tight text-gray-600",children:a?.rawPayload?.productId})}),e.jsx(l,{children:e.jsx(i,{variant:"outline",className:"text-[12px] font-mono tracking-tight text-gray-600",children:a?.rawPayload?.userId})})]},a._id))})]})})]})]})]})]})})}const f=({title:o,value:n,icon:c,color:s,description:p})=>{const x={blue:"from-blue-500/20 to-blue-600/5 text-blue-600 border-blue-100 bg-blue-200",emerald:"from-emerald-500/20 to-emerald-600/5 text-emerald-600 border-emerald-100 bg-emerald-200",amber:"from-amber-500/20 to-amber-600/5 text-amber-600 border-amber-100 bg-amber-200",rose:"from-rose-500/20 to-rose-600/5 text-rose-600 border-rose-100 bg-rose-200",purple:"from-purple-500/20 to-purple-600/5 text-purple-600 border-purple-100 bg-purple-200"},v={blue:"from-blue-300/20 via-blue-500/10 to-transparent text-blue-600 border-blue-200 hover:border-blue-300 hover:shadow-blue-200",emerald:"from-emerald-300/20 via-emerald-500/10 to-transparent text-emerald-600 border-emerald-200 hover:border-emerald-300 hover:shadow-emerald-200",amber:"from-amber-300/20 via-amber-500/10 to-transparent text-amber-600 border-amber-200 hover:border-amber-300 hover:shadow-amber-200",rose:"from-rose-300/20 via-rose-500/10 to-transparent text-rose-600 border-rose-200 hover:border-rose-300 hover:shadow-rose-200",purple:"from-purple-300/20 to-purple-500/10 to-transparent text-purple-600 border-purple-200 hover:border-purple-300 hover:shadow-purple-200"};return e.jsx(m,{className:d("rounded-2xl border shadow-md py-4 bg-gradient-to-br",v[s]),children:e.jsxs(h,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:d("p-3 rounded-2xl bg-gradient-to-br border shadow-sm",x[s]),children:e.jsx(c,{size:22,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:o}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:n}),e.jsx("p",{className:"text-[10px] text-slate-400 font-medium mt-1",children:p})]})]})})},N=({label:o,value:n,icon:c,badge:s,mono:p,capitalize:x})=>e.jsxs("div",{className:"flex items-center gap-3",children:[c&&e.jsx("div",{className:"p-2 bg-slate-200/60 rounded-lg border border-slate-100",children:e.jsx(c,{className:"w-3.5 h-3.5 text-brand-aqua",strokeWidth:2.5})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tighter mb-0.5",children:o}),s?e.jsx(i,{variant:"secondary",className:"capitalize text-[11px] h-5",children:n}):e.jsx("p",{className:`text-sm font-medium text-slate-700 truncate ${p?"font-mono text-xs":""} ${x?"capitalize":""}`,children:n||"N/A"})]})]});export{je as default};
