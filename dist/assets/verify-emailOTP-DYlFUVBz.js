import{D as Ie,r as e,j as c,a as K,s as De,a8 as Ae,i as We,A as Be,E as _e,b2 as Fe,N as fe,b1 as Le}from"./index-Cah9GgNi.js";import{L as He}from"./loader-circle-D_OERo1u.js";const Ge=[["path",{d:"M5 12h14",key:"1ays0h"}]],$e=Ie("minus",Ge);var Ve=Object.defineProperty,ze=Object.defineProperties,qe=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,he=(t,r,a)=>r in t?Ve(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,Ze=(t,r)=>{for(var a in r||(r={}))ve.call(r,a)&&he(t,a,r[a]);if(Q)for(var a of Q(r))ge.call(r,a)&&he(t,a,r[a]);return t},Je=(t,r)=>ze(t,qe(r)),Ke=(t,r)=>{var a={};for(var o in t)ve.call(t,o)&&r.indexOf(o)<0&&(a[o]=t[o]);if(t!=null&&Q)for(var o of Q(t))r.indexOf(o)<0&&ge.call(t,o)&&(a[o]=t[o]);return a};function Qe(t){let r=setTimeout(t,0),a=setTimeout(t,10),o=setTimeout(t,50);return[r,a,o]}function Ue(t){let r=e.useRef();return e.useEffect(()=>{r.current=t}),r.current}var Xe=18,be=40,Ye=`${be}px`,et=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function tt({containerRef:t,inputRef:r,pushPasswordManagerStrategy:a,isFocused:o}){let[f,s]=e.useState(!1),[y,v]=e.useState(!1),[j,R]=e.useState(!1),N=e.useMemo(()=>a==="none"?!1:(a==="increase-width"||a==="experimental-no-flickering")&&f&&y,[f,y,a]),d=e.useCallback(()=>{let h=t.current,k=r.current;if(!h||!k||j||a==="none")return;let E=h,C=E.getBoundingClientRect().left+E.offsetWidth,_=E.getBoundingClientRect().top+E.offsetHeight/2,u=C-Xe,H=_;document.querySelectorAll(et).length===0&&document.elementFromPoint(u,H)===h||(s(!0),R(!0))},[t,r,j,a]);return e.useEffect(()=>{let h=t.current;if(!h||a==="none")return;function k(){let C=window.innerWidth-h.getBoundingClientRect().right;v(C>=be)}k();let E=setInterval(k,1e3);return()=>{clearInterval(E)}},[t,a]),e.useEffect(()=>{let h=o||document.activeElement===r.current;if(a==="none"||!h)return;let k=setTimeout(d,0),E=setTimeout(d,2e3),C=setTimeout(d,5e3),_=setTimeout(()=>{R(!0)},6e3);return()=>{clearTimeout(k),clearTimeout(E),clearTimeout(C),clearTimeout(_)}},[r,o,a,d]),{hasPWMBadge:f,willPushPWMBadge:N,PWM_BADGE_SPACE_WIDTH:Ye}}var xe=e.createContext({}),we=e.forwardRef((t,r)=>{var a=t,{value:o,onChange:f,maxLength:s,textAlign:y="left",pattern:v,placeholder:j,inputMode:R="numeric",onComplete:N,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:h,containerClassName:k,noScriptCSSFallback:E=nt,render:C,children:_}=a,u=Ke(a,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),H,ne,re,ae,le;let[Pe,je]=e.useState(typeof u.defaultValue=="string"?u.defaultValue:""),p=o??Pe,I=Ue(p),G=e.useCallback(n=>{f?.(n),je(n)},[f]),P=e.useMemo(()=>v?typeof v=="string"?new RegExp(v):v:null,[v]),m=e.useRef(null),U=e.useRef(null),X=e.useRef({value:p,onChange:G,isIOS:typeof window<"u"&&((ne=(H=window?.CSS)==null?void 0:H.supports)==null?void 0:ne.call(H,"-webkit-touch-callout","none"))}),Z=e.useRef({prev:[(re=m.current)==null?void 0:re.selectionStart,(ae=m.current)==null?void 0:ae.selectionEnd,(le=m.current)==null?void 0:le.selectionDirection]});e.useImperativeHandle(r,()=>m.current,[]),e.useEffect(()=>{let n=m.current,l=U.current;if(!n||!l)return;X.current.value!==n.value&&X.current.onChange(n.value),Z.current.prev=[n.selectionStart,n.selectionEnd,n.selectionDirection];function g(){if(document.activeElement!==n){V(null),z(null);return}let i=n.selectionStart,b=n.selectionEnd,J=n.selectionDirection,S=n.maxLength,A=n.value,T=Z.current.prev,O=-1,M=-1,W;if(A.length!==0&&i!==null&&b!==null){let Me=i===b,Re=i===A.length&&A.length<S;if(Me&&!Re){let B=i;if(B===0)O=0,M=1,W="forward";else if(B===S)O=B-1,M=B,W="backward";else if(S>1&&A.length>1){let te=0;if(T[0]!==null&&T[1]!==null){W=B<T[1]?"backward":"forward";let Ne=T[0]===T[1]&&T[0]<S;W==="backward"&&!Ne&&(te=-1)}O=te+B,M=te+B+1}}O!==-1&&M!==-1&&O!==M&&m.current.setSelectionRange(O,M,W)}let pe=O!==-1?O:i,me=M!==-1?M:b,Oe=W??J;V(pe),z(me),Z.current.prev=[pe,me,Oe]}if(document.addEventListener("selectionchange",g,{capture:!0}),g(),document.activeElement===n&&Y(!0),!document.getElementById("input-otp-style")){let i=document.createElement("style");if(i.id="input-otp-style",document.head.appendChild(i),i.sheet){let b="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";q(i.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),q(i.sheet,`[data-input-otp]:autofill { ${b} }`),q(i.sheet,`[data-input-otp]:-webkit-autofill { ${b} }`),q(i.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),q(i.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let x=()=>{l&&l.style.setProperty("--root-height",`${n.clientHeight}px`)};x();let w=new ResizeObserver(x);return w.observe(n),()=>{document.removeEventListener("selectionchange",g,{capture:!0}),w.disconnect()}},[]);let[oe,se]=e.useState(!1),[$,Y]=e.useState(!1),[D,V]=e.useState(null),[F,z]=e.useState(null);e.useEffect(()=>{Qe(()=>{var n,l,g,x;(n=m.current)==null||n.dispatchEvent(new Event("input"));let w=(l=m.current)==null?void 0:l.selectionStart,i=(g=m.current)==null?void 0:g.selectionEnd,b=(x=m.current)==null?void 0:x.selectionDirection;w!==null&&i!==null&&(V(w),z(i),Z.current.prev=[w,i,b])})},[p,$]),e.useEffect(()=>{I!==void 0&&p!==I&&I.length<s&&p.length===s&&N?.(p)},[s,N,I,p]);let L=tt({containerRef:U,inputRef:m,pushPasswordManagerStrategy:d,isFocused:$}),ie=e.useCallback(n=>{let l=n.currentTarget.value.slice(0,s);if(l.length>0&&P&&!P.test(l)){n.preventDefault();return}typeof I=="string"&&l.length<I.length&&document.dispatchEvent(new Event("selectionchange")),G(l)},[s,G,I,P]),ue=e.useCallback(()=>{var n;if(m.current){let l=Math.min(m.current.value.length,s-1),g=m.current.value.length;(n=m.current)==null||n.setSelectionRange(l,g),V(l),z(g)}Y(!0)},[s]),ce=e.useCallback(n=>{var l,g;let x=m.current;if(!h&&(!X.current.isIOS||!n.clipboardData||!x))return;let w=n.clipboardData.getData("text/plain"),i=h?h(w):w;n.preventDefault();let b=(l=m.current)==null?void 0:l.selectionStart,J=(g=m.current)==null?void 0:g.selectionEnd,S=(b!==J?p.slice(0,b)+i+p.slice(J):p.slice(0,b)+i+p.slice(b)).slice(0,s);if(S.length>0&&P&&!P.test(S))return;x.value=S,G(S);let A=Math.min(S.length,s-1),T=S.length;x.setSelectionRange(A,T),V(A),z(T)},[s,G,P,p]),Ce=e.useMemo(()=>({position:"relative",cursor:u.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[u.disabled]),de=e.useMemo(()=>({position:"absolute",inset:0,width:L.willPushPWMBadge?`calc(100% + ${L.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:L.willPushPWMBadge?`inset(0 ${L.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:y,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[L.PWM_BADGE_SPACE_WIDTH,L.willPushPWMBadge,y]),Te=e.useMemo(()=>e.createElement("input",Je(Ze({autoComplete:u.autoComplete||"one-time-code"},u),{"data-input-otp":!0,"data-input-otp-placeholder-shown":p.length===0||void 0,"data-input-otp-mss":D,"data-input-otp-mse":F,inputMode:R,pattern:P?.source,"aria-placeholder":j,style:de,maxLength:s,value:p,ref:m,onPaste:n=>{var l;ce(n),(l=u.onPaste)==null||l.call(u,n)},onChange:ie,onMouseOver:n=>{var l;se(!0),(l=u.onMouseOver)==null||l.call(u,n)},onMouseLeave:n=>{var l;se(!1),(l=u.onMouseLeave)==null||l.call(u,n)},onFocus:n=>{var l;ue(),(l=u.onFocus)==null||l.call(u,n)},onBlur:n=>{var l;Y(!1),(l=u.onBlur)==null||l.call(u,n)}})),[ie,ue,ce,R,de,s,F,D,u,P?.source,p]),ee=e.useMemo(()=>({slots:Array.from({length:s}).map((n,l)=>{var g;let x=$&&D!==null&&F!==null&&(D===F&&l===D||l>=D&&l<F),w=p[l]!==void 0?p[l]:null,i=p[0]!==void 0?null:(g=j?.[l])!=null?g:null;return{char:w,placeholderChar:i,isActive:x,hasFakeCaret:x&&w===null}}),isFocused:$,isHovering:!u.disabled&&oe}),[$,oe,s,F,D,u.disabled,p]),ke=e.useMemo(()=>C?C(ee):e.createElement(xe.Provider,{value:ee},_),[_,ee,C]);return e.createElement(e.Fragment,null,E!==null&&e.createElement("noscript",null,e.createElement("style",null,E)),e.createElement("div",{ref:U,"data-input-otp-container":!0,style:Ce,className:k},ke,e.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Te)))});we.displayName="Input";function q(t,r){try{t.insertRule(r)}catch{console.error("input-otp could not insert CSS rule:",r)}}var nt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const ye=e.forwardRef(({className:t,containerClassName:r,...a},o)=>c.jsx(we,{ref:o,containerClassName:K("flex items-center gap-2 has-[:disabled]:opacity-50",r),className:K("disabled:cursor-not-allowed",t),...a}));ye.displayName="InputOTP";const Ee=e.forwardRef(({className:t,...r},a)=>c.jsx("div",{ref:a,className:K("flex items-center",t),...r}));Ee.displayName="InputOTPGroup";const Se=e.forwardRef(({index:t,className:r,...a},o)=>{const f=e.useContext(xe),{char:s,hasFakeCaret:y,isActive:v}=f.slots[t];return c.jsxs("div",{ref:o,className:K("relative flex h-9 w-9 items-center justify-center border-y border border-grey-400 text-sm shadow-md transition-all rounded-md first:border-l last:rounded-r-md",v&&"z-10 ring-1 ring-ring",r),...a,children:[s,y&&c.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:c.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});Se.displayName="InputOTPSlot";const rt=e.forwardRef(({...t},r)=>c.jsx("div",{ref:r,role:"separator",...t,children:c.jsx($e,{})}));rt.displayName="InputOTPSeparator";function at(t){return t.slice(-14).padStart(22,"*")}function st(){const t=De(),r=Ae(),a=We(),{loading:o}=Be(d=>d.auth),f=r.state?.email,[s,y]=e.useState(""),[v,j]=e.useState(30);e.useEffect(()=>{f||t("/auth/forgot-password",{replace:!0})},[f,t]);const R=async()=>{try{const d=await a(Fe({email:f,otp:s})).unwrap();t("../new-password",{state:{email:f,otp:s}}),fe.success(d.message||"OTP verified!",{description:"Please enter new and confirm password."})}catch(d){y(""),fe.error(d||"Failed to send OTP",{description:"Please enter correct otp."})}};e.useEffect(()=>{let d;return v>0&&(d=setInterval(()=>{j(h=>h-1)},1e3)),()=>clearInterval(d)},[v]);const N=async()=>{if(!(v>0))try{await a(Le({email:f})).unwrap(),console.log("OTP Resent to:",f),j(30),y("")}catch(d){console.error("Resend failed:",d)}};return c.jsxs("div",{className:"flex flex-col gap-6 text-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Enter verification code"}),c.jsxs("p",{className:"text-muted-foreground mt-2",children:["We sent a 6-digit code to"," ",c.jsx("span",{className:"font-medium text-foreground",children:at(f)})]})]}),c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"flex justify-center",children:c.jsx(ye,{maxLength:6,value:s,onChange:d=>y(d),children:c.jsx(Ee,{className:"gap-[14px]",children:[...Array(6)].map((d,h)=>c.jsx(Se,{index:h,className:"w-14 h-14 text-lg"},h))})})}),c.jsx(_e,{onClick:R,className:"w-full py-6",disabled:s.length!==6||o,children:o?c.jsx(He,{className:"animate-spin"}):"Verify OTP"}),c.jsxs("div",{className:"text-sm text-muted-foreground",children:["Didn't get the code?"," ",c.jsxs("button",{type:"button",disabled:v>0||o,onClick:N,className:"text-blue-900 font-semibold hover:underline disabled:opacity-90 disabled:cursor-not-allowed",children:["Resend ",v>0&&`(${v}s)`]})]})]})]})}export{st as default};
