import{i as ie,A as le,r as i,ax as O,as as ne,N as o,at as V,ay as ce,az as de,j as e,aA as me,aB as oe,aC as xe,C as W,m as H,n as G,E as $,X as pe,p as q,H as Q,B as I}from"./index-Cah9GgNi.js";import{A as R}from"./ActionDropdown-C1lHW89q.js";import{S as X,a as Y,b as J,c as K,d as h}from"./select-DxUcbfzd.js";import{C as he}from"./circle-x-D3br8V_4.js";import{A as D}from"./award-CjYD8FNm.js";import{C as ue}from"./circle-play-Cxdp-9HA.js";import{M as Z,C as S,P as fe}from"./pen-EW22sn6S.js";import{P as ee}from"./plus-DCZtzpkq.js";import{T as ge}from"./trophy-CRuQjySU.js";import{G as z}from"./gift-CJDpdJoS.js";import{L as se}from"./loader-circle-D_OERo1u.js";import{S as je}from"./search-B7fke5-e.js";import{F as be}from"./funnel-BV6wJkk7.js";import{I as Ne}from"./inbox-DEJGmHq1.js";function u(r){return r.winnerUserId?"COMPLETED":r.failureReason==="Disabled by admin"?"DISABLED":r.isActive?"ACTIVE":"DISABLED"}function Fe(){const r=ie(),{campaigns:l,prizes:x,loading:y,error:p,successMessage:w}=le(s=>s.giveaway),[n,f]=i.useState({date:"",prizeId:"",supportiveItems:""}),[m,E]=i.useState(!1),[g,A]=i.useState(null),[j,ae]=i.useState(""),[b,te]=i.useState("ALL");i.useEffect(()=>{r(O()),r(ne())},[r]),i.useEffect(()=>{w&&(o.success(w),r(V()),r(O())),p&&(o.error(typeof p=="string"?p:p.message),r(V()))},[w,p,r]);const k=i.useCallback(()=>{const s=n.date.trim(),t=n.prizeId.trim();if(!s)return o.error("Campaign date is required"),!1;const a=new Date(s),c=new Date;if(c.setHours(0,0,0,0),!m&&a<c)return o.error("Campaign date cannot be in the past"),!1;const d=new Date(c);if(d.setFullYear(d.getFullYear()+2),a>d)return o.error("Campaign date cannot be more than 2 years in the future"),!1;if(l.find(N=>{if(m&&N._id===g)return!1;const B=new Date(N.date);return B.setHours(0,0,0,0),B.getTime()===a.getTime()}))return o.error("A campaign already exists for this date"),!1;if(!t)return o.error("Please select a prize"),!1;const U=x.find(N=>N._id===t);return U?U.isActive?!0:(o.error("Selected prize is inactive"),!1):(o.error("Selected prize not found"),!1)},[n,l,x,m,g]),re=i.useCallback(()=>{if(!k())return;const s=n.supportiveItems.split(",").map(t=>t.trim()).filter(Boolean);m?(r(ce({id:g,payload:{date:n.date,prizeId:n.prizeId,supportiveItems:s}})),C()):(r(de({date:n.date,prizeId:n.prizeId,supportiveItems:s})),C())},[n,k,r,m,g]),C=i.useCallback(()=>{f({date:"",prizeId:"",supportiveItems:""}),E(!1),A(null)},[]),T=i.useCallback(s=>{const t=typeof s.prizeId=="object"?s.prizeId._id:s.prizeId;f({date:new Date(s.date).toISOString().split("T")[0],prizeId:t,supportiveItems:s.supportiveItems?s.supportiveItems.join(", "):""}),E(!0),A(s._id),window.scrollTo({top:0,behavior:"smooth"})},[]),L=i.useCallback(s=>{switch(s){case"ACTIVE":return e.jsx(ue,{className:"h-3.5 w-3.5"});case"COMPLETED":return e.jsx(D,{className:"h-3.5 w-3.5"});default:return e.jsx(he,{className:"h-3.5 w-3.5"})}},[]),P=i.useCallback(s=>{switch(s){case"ACTIVE":return"bg-emerald-50 text-emerald-700 border-emerald-200";case"COMPLETED":return"bg-blue-50 text-blue-700 border-blue-200";default:return"bg-red-50 text-red-700 border-red-200"}},[]),_=i.useCallback((s,t)=>{const a=[];return t!=="COMPLETED"&&a.push({label:"Edit",onClick:()=>{const c=l.find(d=>d._id===s);c&&T(c)}}),t==="ACTIVE"&&a.push({label:"Disable",onClick:()=>r(me(s))}),t==="DISABLED"&&a.push({label:"Activate",onClick:()=>r(oe(s))}),t!=="COMPLETED"&&a.push({label:"Delete",destructive:!0,onClick:()=>{const c=l.find(d=>d._id===s);window.confirm(`Are you sure you want to delete the campaign for ${new Date(c.date).toDateString()}? This action cannot be undone.`)&&r(xe(s))}}),a},[l,r,T]),v=i.useMemo(()=>{let s=[...l];if(b!=="ALL"&&(s=s.filter(t=>u(t)===b)),j.trim()){const t=j.toLowerCase().trim();s=s.filter(a=>x.find(d=>d._id===(a.prizeId?._id||a.prizeId))?.title?.toLowerCase().includes(t))}return s},[l,b,j,x]),F=i.useMemo(()=>l.filter(s=>u(s)==="ACTIVE").length,[l]),M=i.useMemo(()=>l.filter(s=>u(s)==="COMPLETED").length,[l]);return e.jsx("div",{className:"min-h-screen bg-gray-50/50 p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-black to-black shadow-lg",children:e.jsx(Z,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Campaigns"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your giveaway campaigns"})]})]}),e.jsxs(W,{className:"border-0 shadow-sm shadow-gray-200/50",children:[e.jsx(H,{className:"border-b border-gray-100 bg-gray-50/50 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(G,{className:"flex items-center gap-2 text-base font-semibold text-gray-800",children:[e.jsx(ee,{className:"h-4 w-4 text-black"}),m?"Edit Campaign":"Create New Campaign"]}),m&&e.jsxs($,{variant:"outline",size:"sm",onClick:C,className:"gap-2",children:[e.jsx(pe,{className:"h-3.5 w-3.5"}),"Cancel Edit"]})]})}),e.jsx(q,{className:"p-5",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600",children:[e.jsx(S,{className:"h-3.5 w-3.5"}),"Campaign Date"]}),e.jsx(Q,{type:"date",value:n.date,onChange:s=>f({...n,date:s.target.value}),className:"h-10 border-gray-200 bg-white focus:border-amber-300 focus:ring-amber-200",min:m?void 0:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600",children:[e.jsx(ge,{className:"h-3.5 w-3.5"}),"Select Prize"]}),e.jsxs(X,{value:n.prizeId,onValueChange:s=>f({...n,prizeId:s}),children:[e.jsx(Y,{className:"h-10 border-gray-200 bg-white focus:border-amber-300 focus:ring-amber-200",children:e.jsx(J,{placeholder:"Choose a prize"})}),e.jsx(K,{children:x.length===0?e.jsx("div",{className:"p-2 text-sm text-gray-500",children:"No prizes available"}):x.filter(s=>s.isActive).map(s=>e.jsx(h,{value:s._id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-3.5 w-3.5 text-amber-500"}),s.title]})},s._id))})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx($,{onClick:re,disabled:y,className:"h-10 w-full gap-2 bg-gradient-to-r from-black to-black font-medium shadow-md transition-all hover:shadow-lg",children:y?e.jsx(se,{className:"h-4 w-4 animate-spin"}):m?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4"}),"Update Campaign"]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4"}),"Create Campaign"]})})})]})})]}),e.jsxs(W,{className:"border-0 shadow-sm shadow-gray-200/50",children:[e.jsx(H,{className:"border-b border-gray-100 bg-gray-50/50 pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(G,{className:"flex items-center gap-2 text-base font-semibold text-gray-800",children:[e.jsx(Z,{className:"h-4 w-4 text-black"}),"All Campaigns"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"secondary",className:"bg-black text-white",children:[l.length," Total"]}),F>0&&e.jsxs(I,{className:"bg-emerald-100 text-emerald-700",children:[F," Active"]}),M>0&&e.jsxs(I,{className:"bg-blue-100 text-blue-700",children:[M," Completed"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(je,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(Q,{placeholder:"Search by prize name...",value:j,onChange:s=>ae(s.target.value),className:"h-9 border-gray-200 bg-white pl-9 focus:border-amber-300 focus:ring-amber-200"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-gray-400"}),e.jsxs(X,{value:b,onValueChange:te,children:[e.jsx(Y,{className:"h-9 w-[180px] border-gray-200 bg-white focus:border-amber-300 focus:ring-amber-200",children:e.jsx(J,{placeholder:"Filter by status"})}),e.jsxs(K,{children:[e.jsx(h,{value:"ALL",children:"All Status"}),e.jsx(h,{value:"ACTIVE",children:"Active"}),e.jsx(h,{value:"DISABLED",children:"Disabled"}),e.jsx(h,{value:"COMPLETED",children:"Completed"})]})]})]})]})]})}),e.jsx(q,{className:"p-0",children:y&&l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[e.jsx(se,{className:"h-8 w-8 animate-spin text-black"}),e.jsx("p",{className:"mt-3 text-sm font-medium",children:"Loading campaigns..."})]}):v.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-gray-100",children:e.jsx(Ne,{className:"h-8 w-8"})}),e.jsx("p",{className:"mt-4 font-medium text-gray-600",children:l.length===0?"No campaigns yet":"No campaigns found"}),e.jsx("p",{className:"mt-1 text-sm",children:l.length===0?"Create your first campaign above":"Try adjusting your search or filters"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden overflow-x-auto md:block",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100 bg-gray-50/80 text-xs font-medium uppercase tracking-wider text-gray-500",children:[e.jsx("th",{className:"px-5 py-3.5 text-left",children:"Date"}),e.jsx("th",{className:"px-5 py-3.5 text-left",children:"Prize"}),e.jsx("th",{className:"px-5 py-3.5 text-left",children:"Status"}),e.jsx("th",{className:"px-5 py-3.5 text-left",children:"Winner"}),e.jsx("th",{className:"px-5 py-3.5 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:v.map(s=>{const t=x.find(d=>d._id===(s.prizeId?._id||s.prizeId)),a=u(s),c=_(s._id,a);return e.jsxs("tr",{className:"transition-colors hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:new Date(s.date).toDateString()})]})}),e.jsx("td",{className:"px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-black"}),e.jsx("span",{className:"font-medium text-gray-800",children:t?.title||"—"})]})}),e.jsx("td",{className:"px-5 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs font-medium ${P(a)}`,children:[L(a),a]})}),e.jsx("td",{className:"px-5 py-4",children:s.winnerUserId?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:typeof s.winnerUserId=="object"?s.winnerUserId.email||s.winnerUserId.phone||"Winner":"Winner Found"})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"No winner yet"})}),e.jsx("td",{className:"px-5 py-4 text-right",children:e.jsx(R,{actions:c})})]},s._id)})})]})}),e.jsx("div",{className:"divide-y divide-gray-100 md:hidden",children:v.map(s=>{const t=x.find(d=>d._id===(s.prizeId?._id||s.prizeId)),a=u(s),c=_(s._id,a);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-black"}),e.jsx("span",{className:"font-semibold text-gray-800",children:t?.title||"—"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(S,{className:"h-3.5 w-3.5"}),new Date(s.date).toDateString()]}),s.winnerUserId&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-3.5 w-3.5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-700",children:typeof s.winnerUserId=="object"?s.winnerUserId.email||s.winnerUserId.phone||"Winner":"Winner Found"})]})]}),e.jsx(R,{actions:c})]}),e.jsx("div",{className:"mt-3 flex items-center gap-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs font-medium ${P(a)}`,children:[L(a),a]})})]},s._id)})})]})})]})]})})}export{Fe as default};
