import{i as R,A,r as n,as as B,at as F,j as e,C as L,J as _,B as g,H as u,E as q,aD as T}from"./index-Cah9GgNi.js";import{S as V,a as O,b as G,c as H,d as v}from"./select-DxUcbfzd.js";import{C as D}from"./circle-check-big-ChBinIN1.js";import{I as J}from"./info-CpdJOb3o.js";import{C as j}from"./circle-alert-CnaEjTQV.js";import{L as C}from"./loader-circle-D_OERo1u.js";function Y(){const l=R(),{prizes:p,loading:c,bulkCampaignLoading:i,error:m,successMessage:h,bulkCampaignSummary:r}=A(s=>s.giveaway),[a,x]=n.useState({startDate:"",endDate:"",prizeId:"",supportiveItems:""}),[t,o]=n.useState({}),[I,f]=n.useState(!1);n.useEffect(()=>{l(B())},[l]),n.useEffect(()=>{if(h||m){const s=setTimeout(()=>{l(F()),f(!1)},8e4);return()=>clearTimeout(s)}},[h,m,l]),n.useEffect(()=>{r&&f(!0)},[r]);const y=()=>{const s={};if(a.startDate.trim()||(s.startDate="Start date is required"),a.endDate.trim()||(s.endDate="End date is required"),a.startDate&&a.endDate){const d=new Date(a.startDate),P=new Date(a.endDate);d>P&&(s.dateRange="End date must be after start date")}return a.prizeId.trim()||(s.prizeId="Prize selection is required"),o(s),Object.keys(s).length===0},S=()=>{if(!y())return;const s=a.supportiveItems.split(",").map(d=>d.trim()).filter(Boolean);l(T({ranges:[{startDate:a.startDate,endDate:a.endDate,prizeId:a.prizeId,supportiveItems:s}],isActive:!0})),m||(x({startDate:"",endDate:"",prizeId:"",supportiveItems:""}),o({}))},z=s=>{x({...a,prizeId:s}),t.prizeId&&o({...t,prizeId:""})},w=s=>{x({...a,startDate:s}),(t.startDate||t.dateRange)&&o({...t,startDate:"",dateRange:""})},k=s=>{x({...a,endDate:s}),(t.endDate||t.dateRange)&&o({...t,endDate:"",dateRange:""})},E=s=>new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),b=p.filter(s=>s.isActive),N=p.filter(s=>!s.isActive);return e.jsxs(L,{className:"p-6 space-y-4 max-w-3xl",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Bulk Create Campaigns"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create campaigns for a date range using one prize"})]}),h&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-800",children:[e.jsx(D,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:h})]}),I&&r&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Campaign Creation Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"text-blue-800",children:[e.jsx("strong",{children:r.created})," campaigns created"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-orange-600"}),e.jsxs("span",{className:"text-blue-800",children:[e.jsx("strong",{children:r.skipped})," dates skipped"]})]})]})]})]})}),r.skipped>0&&r.skippedDates&&e.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-orange-900 mb-2 text-sm",children:"Skipped Dates:"}),e.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:r.skippedDates.map((s,d)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-white p-2 rounded border border-orange-100",children:[e.jsx("span",{className:"font-medium text-gray-700",children:E(s.date)}),e.jsx(g,{variant:s.reason==="Past date"?"destructive":"secondary",className:"text-xs",children:s.reason})]},d))})]})]}),m&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-800",children:[e.jsx(j,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:m})]}),t.dateRange&&e.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg flex items-center gap-2 text-orange-800",children:[e.jsx(j,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:t.dateRange})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{type:"date",value:a.startDate,onChange:s=>w(s.target.value),disabled:c||i,className:t.startDate?"border-red-500":""}),t.startDate&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.startDate})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["End Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{type:"date",value:a.endDate,onChange:s=>k(s.target.value),disabled:c||i,className:t.endDate?"border-red-500":""}),t.endDate&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.endDate})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Prize ",e.jsx("span",{className:"text-red-500",children:"*"})]}),c?e.jsx("div",{className:"flex items-center justify-center h-10 bg-gray-100 rounded-md",children:e.jsx(C,{className:"w-4 h-4 animate-spin text-gray-500"})}):e.jsxs(V,{value:a.prizeId,onValueChange:z,disabled:i,children:[e.jsx(O,{className:t.prizeId?"border-red-500":"",children:e.jsx(G,{placeholder:"Select Prize"})}),e.jsxs(H,{children:[b.length>0&&e.jsx(e.Fragment,{children:b.map(s=>e.jsx(v,{value:s._id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.title,e.jsx(g,{variant:"success",className:"ml-2",children:"Active"})]})},s._id))}),N.length>0&&e.jsx(e.Fragment,{children:N.map(s=>e.jsx(v,{value:s._id,disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.title,e.jsx(g,{variant:"destructive",className:"ml-2",children:"Inactive"})]})},s._id))}),p.length===0&&e.jsx("div",{className:"p-2 text-center text-gray-500 text-sm",children:"No prizes available"})]})]}),t.prizeId&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.prizeId})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Supportive Items ",e.jsx("span",{className:"text-gray-400",children:"(Optional)"})]}),e.jsx(u,{placeholder:"Item 1, Item 2, Item 3",value:a.supportiveItems,onChange:s=>x({...a,supportiveItems:s.target.value}),disabled:i}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Separate items with commas"})]})]}),e.jsx(q,{onClick:S,disabled:c||i,className:"w-full",children:i?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Campaigns..."]}):"Create Campaigns"}),p.length===0&&!c&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-800 text-sm",children:"No prizes found. Please create a prize first."})]})}export{Y as default};
