import{D as g,i as R,A as U,r as c,aT as b,aU as f,aV as w,aW as V,j as e,C as d,E as x,F,aX as B,aY as H,B as k,aZ as W}from"./index-Cah9GgNi.js";import{T as X}from"./textarea-BdgJi3SO.js";import{S,a as C,b as M,c as A,d as n}from"./select-DxUcbfzd.js";import{L as _}from"./loader-circle-D_OERo1u.js";import{S as $}from"./shield-alert-DrSlsao2.js";const q=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],P=g("snowflake",q);const Y=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Z=g("trash-2",Y);const G=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],I=g("user-x",G);function se({matchId:t}){const a=R(),{selected:i,history:p,selectedMessageIds:m,loading:h,error:j,successMessage:o}=U(s=>s.chatManagement||{}),[r,L]=c.useState("delete_message"),[y,z]=c.useState(""),[v,D]=c.useState(""),u=i?.participants||[],N=i?.messages||[];c.useEffect(()=>{t&&(a(b({matchId:t})),a(f(t)))},[a,t]),c.useEffect(()=>{o&&(a(b({matchId:t})),a(f(t)),a(w()),setTimeout(()=>a(V()),2e3))},[o,a,t]);const T=s=>{s.preventDefault();const l={matchId:t,action:r,reason:y};r==="delete_message"&&(l.messageIds=m),(r==="warn_user"||r==="block_user")&&(l.userId=v),a(W(l))},E=c.useMemo(()=>{const s=new Set(m);return l=>s.has(l)},[m]);return h&&!i?e.jsx("div",{className:"min-h-screen bg-gray-50/50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(_,{className:"w-8 h-8 animate-spin text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Loading chat..."})]})}):j?e.jsx("div",{className:"min-h-screen bg-gray-50/50 p-4 md:p-6 lg:p-8",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:j})})}):i?e.jsx("div",{className:"min-h-screen bg-gray-50/50 p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{variant:"outline",size:"icon",asChild:!0,className:"bg-transparent",children:e.jsx("a",{href:"/admin/management/chat",children:e.jsx(F,{className:"w-4 h-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Chat Review"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Match: ",i.matchId||t]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs(d,{className:"border-0 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Messages (",N.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>a(B()),children:"Select All"}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>a(w()),children:"Clear"})]})]}),e.jsx("div",{className:"p-4 space-y-2 max-h-[70vh] overflow-y-auto bg-white",children:N.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-2 border border-gray-100 rounded-lg",children:[e.jsx("input",{type:"checkbox",className:"mt-1",checked:E(s.id),onChange:()=>a(H(s.id))}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"outline",children:s.sender}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleString()}),s.flagged&&e.jsx(k,{variant:"destructive",children:"Flagged"})]}),e.jsx("div",{className:"text-sm text-gray-800 whitespace-pre-wrap mt-1",children:s.text||(s.media?.length?"[media]":"")})]})]},s.id))})]}),e.jsxs(d,{className:"border-0 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:"Action History"}),e.jsxs("div",{className:"p-4 space-y-2",children:[(p||[]).length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No actions yet"}),p?.map((s,l)=>e.jsxs("div",{className:"p-3 border border-gray-100 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-800",children:s.resolution}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(s.resolvedAt).toLocaleString()})]},l))]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"lg:sticky lg:top-6 space-y-4",children:[e.jsxs(d,{className:"border-0 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:"Take Action"}),e.jsxs("form",{onSubmit:T,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Action"}),e.jsxs(S,{value:r,onValueChange:L,children:[e.jsx(C,{children:e.jsx(M,{})}),e.jsxs(A,{children:[e.jsx(n,{value:"delete_message",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"})," Delete Message(s)"]})}),e.jsx(n,{value:"warn_user",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"})," Warn User"]})}),e.jsx(n,{value:"block_user",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"})," Block User"]})}),e.jsx(n,{value:"freeze_chat",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"})," Freeze Chat"]})})]})]})]}),(r==="warn_user"||r==="block_user")&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"User"}),e.jsxs(S,{value:v,onValueChange:D,children:[e.jsx(C,{children:e.jsx(M,{placeholder:"Select user"})}),e.jsx(A,{children:u.map(s=>e.jsx(n,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Reason"}),e.jsx(X,{value:y,onChange:s=>z(s.target.value),placeholder:"Enter reason",className:"resize-none",rows:3})]}),e.jsx(x,{type:"submit",disabled:h,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2 animate-spin"}),"Applying..."]}):"Apply Action"}),o&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 p-2 rounded",children:o})]})]}),e.jsxs(d,{className:"border-0 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:"Participants"}),e.jsx("div",{className:"p-4 space-y-2",children:u.map(s=>e.jsx("div",{className:"text-sm text-gray-800",children:s},s))})]})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50/50 p-4 md:p-6 lg:p-8",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx(d,{className:"p-8 text-center border-0 shadow-sm",children:e.jsx("p",{className:"text-gray-500",children:"Chat not found"})})})})}export{se as default};
