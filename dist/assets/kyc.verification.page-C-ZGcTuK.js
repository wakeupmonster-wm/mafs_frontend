import{D as Y,r as m,j as e,H as $,z as C,B as p,W as V,Y as K,E as f,a as D,Z as E,$ as P,a0 as B,a1 as z,_ as S,a2 as H,a3 as _,a4 as I,a5 as W,a6 as X,a7 as T,S as L,P as G,M as J,J as Z,ar as Q,i as ee,a8 as ae,A as se,cs as te,ct as re,N as q}from"./index-Cah9GgNi.js";import{P as ne}from"./headSubhead-C7X6Yce6.js";import{u as ie,f as A,a as le,b as oe,g as ce,c as de}from"./index-BXaOFAvc.js";import{L as me}from"./label-DJ1n1SI_.js";import{S as xe,a as he,b as pe,c as ue,d as ge}from"./select-DxUcbfzd.js";import{T as be,D as je}from"./data.not-found-BokaeWBd.js";import{I as fe,a as y}from"./IconX-D4kkSzeq.js";import{A as M}from"./index-Eb3V4Lej.js";import{I as Ne}from"./IconFilter-D5y8yHeQ.js";import{C as we}from"./circle-check-big-ChBinIN1.js";import{C as R}from"./circle-x-D3br8V_4.js";import{C as ye}from"./clock-BveIEetd.js";import{F as ve}from"./file-text-C62tHutv.js";import{C as Ce}from"./camera-mL6fQ4Ex.js";import{E as Se}from"./ellipsis-BTTzz4hy.js";import{E as ke}from"./eye-Ud1Tzidn.js";import{D as Fe,b as De,c as Ie,d as Me}from"./dialog-CgcypPnB.js";import{M as Pe}from"./maximize-2-DH_BjqFn.js";import{C as ze}from"./ConfirmModal-FgUfmtBl.js";import"./index-657d2hlm.js";import"./IconLoader-QBct0fFV.js";import"./triangle-alert-1qeuYxI_.js";const Be=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Te=Y("download",Be);function qe({columns:n,data:x,rowCount:r,pagination:s,onPaginationChange:o,searchPlaceholder:u="Search...",globalFilter:h,setGlobalFilter:g,isLoading:v,meta:N,filters:t}){const[b,j]=m.useState([]),l=ie({data:x,columns:n,rowCount:r,onSortingChange:j,manualSorting:!1,manualPagination:!0,manualFiltering:!0,onPaginationChange:o,onGlobalFilterChange:g,getSortedRowModel:de(),getCoreRowModel:ce(),state:{sorting:b,pagination:s,globalFilter:h},meta:N}),w=t.statusFilter||t.sortBy;return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row flex-wrap md:items-center justify-between gap-4 p-2 rounded-xl",children:[e.jsxs("div",{className:"relative w-3/5 md:w-1/3",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 z-10"}),e.jsx($,{placeholder:u,className:"pl-9 pr-10 bg-white border-slate-200 h-10 shadow-sm focus-visible:ring-brand-aqua rounded-lg",value:h??"",onChange:a=>g(a.target.value)}),h&&e.jsx("button",{onClick:()=>g(""),className:"absolute right-3 top-1/2 -translate-y-1/2 group flex items-center justify-center rounded-full p-1 bg-brand-aqua/30 hover:bg-brand-aqua transition-colors duration-200","aria-label":"Clear search",children:e.jsx(y,{className:"h-4 w-4 text-slate-600 group-hover:text-slate-800 transition-colors"})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 min-w-0 flex-1 ml-4",children:[e.jsx("div",{className:"hidden sm:flex flex-1 items-center justify-end gap-2 overflow-x-hidden min-w-0",children:e.jsxs(M,{mode:"popLayout",children:[t.statusFilter&&e.jsx(C.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:"shrink-0",children:e.jsxs(p,{variant:"secondary",className:"p-2 gap-1 bg-indigo-100 border-dashed border-indigo-400 text-indigo-700 shadow-sm whitespace-nowrap",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase opacity-50",children:"Status:"}),e.jsx("span",{className:"capitalize text-xs",children:t.statusFilter}),e.jsx("button",{onClick:()=>t.setStatusFilter(""),className:"ml-1 p-0.5 rounded-full hover:bg-indigo-200 transition-colors",children:e.jsx(y,{size:12})})]})},"status-chip"),t.sortBy&&e.jsx(C.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:"shrink-0",children:e.jsxs(p,{variant:"secondary",className:"p-2 gap-1 bg-slate-100 border-dashed border-slate-400 text-slate-700 shadow-sm whitespace-nowrap",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase opacity-50",children:"Sort:"}),e.jsx("span",{className:"capitalize text-xs",children:t.sortBy}),e.jsx("button",{onClick:()=>t.setSortBy(""),className:"ml-1 p-0.5 rounded-full hover:bg-slate-200 transition-colors",children:e.jsx(y,{size:12})})]})},"sort-chip")]})}),(t.statusFilter||t.sortBy)&&e.jsx("div",{className:"hidden sm:block w-0.5 h-6 bg-slate-200 shrink-0"}),e.jsx("div",{className:"shrink-0",children:e.jsxs(V,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(f,{variant:"outline",className:D("h-10 border-brand-aqua/80 shadow-sm bg-brand-aqua/5 hover:bg-brand-aqua/30 transition-all whitespace-nowrap",w&&"border-brand-aqua ring-1 ring-brand-aqua"),children:[e.jsx(Ne,{strokeWidth:2.5,className:D("h-6 w-6",w?"text-brand-aqua":"text-brand-aqua/60")}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Filters"}),(t.statusFilter||t.sortBy)&&e.jsx("span",{className:"ml-2 flex h-5 w-5 items-center justify-center rounded-full bg-brand-aqua text-[10px] text-white font-bold",children:+(t.statusFilter!=="")+ +(t.sortBy!=="")})]})}),e.jsxs(E,{align:"end",className:"w-56 p-2 shadow-xl border-slate-200",children:[e.jsx(P,{className:"text-xs text-slate-500 font-bold uppercase tracking-wider",children:"Verification Status"}),["pending","approved","rejected"].map(a=>e.jsx(B,{checked:t.statusFilter===a,onCheckedChange:()=>t.setStatusFilter(a),className:"capitalize",children:a},a)),e.jsx(z,{}),e.jsx(P,{className:"text-xs text-slate-500 font-bold uppercase tracking-wider",children:"Sort Order"}),[{id:"newest",label:"Newest First"},{id:"oldest",label:"Oldest First"},{id:"name",label:"Alphabetical"}].map(a=>e.jsx(B,{checked:t.sortBy===a.id,onCheckedChange:()=>t.setSortBy(a.id),children:a.label},a.id)),(t.statusFilter||t.sortBy)&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(S,{className:"text-red-600 justify-center font-medium focus:bg-red-50 focus:text-red-700 cursor-pointer",onClick:()=>{t.setStatusFilter(""),t.setSortBy("")},children:"Clear All Filters"})]})]})]})})]})]}),e.jsx("div",{className:"flex justify-end sm:hidden flex-wrap gap-2 px-1",children:e.jsx(M,{children:(t.statusFilter||t.sortBy)&&e.jsxs(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex flex-wrap items-center gap-2",children:[t.statusFilter&&e.jsxs(p,{variant:"secondary",className:"bg-indigo-50 text-indigo-700 border-indigo-100 py-1",children:["Status:"," ",e.jsx("span",{className:"capitalize ml-1",children:t.statusFilter}),e.jsx("button",{onClick:()=>t.setStatusFilter(""),className:"ml-1",children:e.jsx(y,{size:12})})]}),t.isPremium!==void 0&&e.jsxs(p,{variant:"secondary",className:"bg-amber-50 text-amber-700 border-amber-100 py-1",children:["Sort:"," ",e.jsx("span",{className:"ml-1",children:t.sortBy?"Newest":"Oldest"}),e.jsx("button",{onClick:()=>t.setSortBy(void 0),className:"ml-1",children:e.jsx(y,{size:12})})]})]})})})]}),e.jsx("div",{className:"block rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:e.jsxs(H,{children:[e.jsx(_,{className:"bg-slate-50/50",children:l.getHeaderGroups().map(a=>e.jsx(I,{children:a.headers.map(c=>e.jsx(W,{className:"text-slate-700 w-max pl-10 font-semibold h-10 bg-slate-100 text-xs",children:A(c.column.columnDef.header,c.getContext())},c.id))},a.id))}),e.jsx(X,{className:D(v&&"opacity-50 pointer-events-none transition-opacity"),children:e.jsx(M,{mode:"popLayout",children:l.getRowModel().rows?.length?l.getRowModel().rows.map(a=>e.jsx(I,{className:"hover:bg-slate-50/50",children:a.getVisibleCells().map(c=>e.jsx(T,{className:"py-3 pl-10",children:A(c.column.columnDef.cell,c.getContext())},c.id))},a.id)):e.jsx(I,{children:e.jsx(T,{colSpan:n.length,className:"h-64 text-center",children:v?e.jsx(be,{text:"Fetching data..."}):e.jsx(je,{icon:e.jsx(L,{className:"w-8 h-8 text-brand-aqua"}),message:"No results found for your search"})})})})})]})}),e.jsxs("div",{className:"flex flex-row items-center justify-between gap-4 py-2 border-t border-slate-100 mt-4 px-5 md:px-0",children:[e.jsxs("div",{className:"text-xs font-medium text-slate-500",children:["Showing ",x.length," of ",r," results"]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"hidden sm:block text-[10px] font-bold text-slate-400 uppercase",children:"Rows"}),e.jsxs(xe,{value:`${l.getState().pagination.pageSize}`,onValueChange:a=>l.setPageSize(Number(a)),children:[e.jsx(he,{className:"h-8 w-[70px] text-xs",children:e.jsx(pe,{})}),e.jsx(ue,{children:[10,20,50].map(a=>e.jsx(ge,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:e.jsx(le,{size:16})}),e.jsxs("div",{className:"text-xs font-semibold px-2",children:[l.getState().pagination.pageIndex+1," /"," ",l.getPageCount()]}),e.jsx(f,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:e.jsx(oe,{size:16})})]})]})]})]})}const Ae=(n,x)=>[{id:"sno",header:"S.no",cell:({row:r,table:s})=>{const{pageIndex:o,pageSize:u}=s.getState().pagination,h=o*u+r.index+1;return e.jsx("div",{className:"text-center font-medium",children:h})},enableSorting:!1,enableHiding:!1},{accessorKey:"nickname",header:"User",cell:({row:r})=>e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-bold text-slate-900",children:r.original.nickname||"-"})})},{accessorKey:"user.phone",header:"Phone Number",cell:({row:r})=>{const s=r.original.user?.phone;if(!s)return e.jsx("span",{className:"text-slate-400 text-xs italic",children:"Not provided"});const o=()=>{navigator.clipboard.writeText(s),toast.success("Phone number copied!")};return e.jsxs(p,{onClick:o,className:"cursor-pointer bg-gray-100 text-gray-700 border-gray-200 hover:bg-gray-200 transition-all",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),s]})}},{accessorKey:"user.email",header:()=>e.jsx("div",{className:"w-max text-center text-xs",children:"Email Address"}),cell:({row:r})=>{const s=r.original.user?.email;return s?e.jsxs(p,{className:"lowercase font-normal bg-gray-100 text-gray-700 border border-gray-200 transition-all duration-200 hover:bg-gray-200 hover:scale-105",children:[e.jsx(J,{className:"w-3 h-3 mr-1.5 text-slate-500"}),s]}):e.jsx("span",{className:"text-slate-400 text-xs italic",children:"No email"})}},{accessorKey:"verification.status",header:"Status",cell:({row:r})=>{const s=(r.original.verification?.status||r.original.kycStatus||"pending").toLowerCase(),o={pending:"bg-amber-100 text-amber-700 border-amber-200",approved:"bg-emerald-100 text-emerald-700 border-emerald-200",rejected:"bg-red-100 text-red-700 border-red-200"};return e.jsxs(p,{className:`
          capitalize font-medium transition-all duration-200 hover:scale-105
          ${o[s]||o.pending}
        `,children:[s==="approved"&&e.jsx(we,{className:"w-3 h-3 mr-1"}),s==="rejected"&&e.jsx(R,{className:"w-3 h-3 mr-1"}),s==="pending"&&e.jsx(ye,{className:"w-3 h-3 mr-1 animate-pulse"}),s]})}},{accessorKey:"createdAt",header:"Submitted At",cell:({row:r})=>{const s=r.original.verification?.submittedAt||r.original.createdAt;return e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 font-medium whitespace-nowrap",children:[e.jsx(Z,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("span",{className:"text-sm",children:new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})}},{id:"documents",header:"Documents",cell:({row:r})=>{const{verification:s}=r.original;return e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{size:"icon",variant:"outline",className:"h-8 w-8 border-gray-300 hover:bg-gray-100 hover:border-gray-400 transition-all duration-200 hover:scale-110",disabled:!s?.docUrl,onClick:()=>x({open:!0,src:s?.docUrl,title:"ID Document"}),children:e.jsx(ve,{className:"w-4 h-4 text-gray-600"})}),e.jsx(f,{size:"icon",variant:"outline",className:"h-8 w-8 border-gray-300 hover:bg-gray-100 hover:border-gray-400 transition-all duration-200 hover:scale-110",disabled:!s?.selfieUrl,onClick:()=>x({open:!0,src:s?.selfieUrl,title:"User Selfie"}),children:e.jsx(Ce,{className:"w-4 h-4 text-gray-600"})})]})}},{id:"actions",header:()=>e.jsx("div",{className:"w-max text-center mr-4 text-xs",children:"Actions"}),cell:({row:r})=>{const s=r.original;return e.jsxs(V,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(f,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-slate-100",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Se,{className:"h-4 w-4 text-slate-600"})]})}),e.jsxs(E,{align:"end",className:"w-48 p-2 shadow-lg",children:[e.jsx(P,{className:"text-xs text-slate-500 font-bold uppercase tracking-wider",children:"Verification Actions"}),e.jsxs(S,{className:"cursor-pointer gap-2 py-2",onClick:()=>{},children:[e.jsx(ke,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{children:"View Profile Details"})]}),e.jsx(z,{}),e.jsxs(S,{className:"cursor-pointer gap-2 py-2 text-emerald-600 focus:text-emerald-700 focus:bg-emerald-50",onClick:()=>n(s.userId,"approve"),children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Approve KYC"})]}),e.jsxs(S,{className:"cursor-pointer gap-2 py-2 text-red-600 focus:text-red-700 focus:bg-red-50",onClick:()=>n(s.userId,"reject","Document unclear"),children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Reject KYC"})]})]})]})}}];function Re({config:n,onClose:x}){if(!n.src)return null;const r=()=>{const s=document.createElement("a");s.href=n.src,s.download=`${n.title.replace(/\s+/g,"_")}.jpg`,s.click()};return e.jsx(Fe,{open:n.open,onOpenChange:x,children:e.jsxs(De,{className:"max-w-4xl w-[95vw] h-[90vh] flex flex-col p-0 overflow-hidden bg-slate-950 border-slate-800",children:[e.jsxs(Ie,{className:"p-4 bg-white border-b flex flex-row items-center justify-between space-y-0",children:[e.jsxs(Me,{className:"text-slate-900 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-brand-aqua"}),n.title]}),e.jsx("div",{className:"flex items-center gap-2 mr-14",children:e.jsxs(f,{variant:"outline",size:"sm",onClick:r,className:"h-8",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"})," Download"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-4 bg-black/40",children:e.jsx("img",{src:n.src,alt:n.title,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl transition-transform duration-300 hover:scale-105"})})]})})}const Ve={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}};function la(){const n=ee(),x=ae(),{pendingVerifications:r,loading:s,pagination:o}=se(i=>i.verification),[u,h]=m.useState(""),[g,v]=m.useState(""),[N,t]=m.useState(""),[b,j]=m.useState({pageIndex:0,pageSize:10}),[l,w]=m.useState({open:!1,src:"",title:""}),[a,c]=m.useState({isOpen:!1,userId:null,action:"",nickname:""}),k=x?.state;m.useEffect(()=>{k&&(j(i=>({...i,pageIndex:0})),k==="Pending"&&h("pending"))},[k]),m.useEffect(()=>{const i=setTimeout(()=>{n(te({page:b.pageIndex+1,limit:b.pageSize,search:N,status:u,sortBy:g}))},500);return()=>clearTimeout(i)},[n,b.pageIndex,b.pageSize,u,g,N]);const O=m.useMemo(()=>Ae((i,d,F)=>{c({isOpen:!0,userId:i,action:d,nickname:F})},i=>w(i)),[n]),U=()=>{const{userId:i,action:d}=a;n(re({userId:i,action:d,reason:d==="reject"?"Documents did not meet requirements":""})).unwrap().then(()=>{q.success(`User ${d}ed successfully`),c({...a,isOpen:!1})}).catch(F=>q.error(F||"Action failed"))};return e.jsxs("div",{className:"flex flex-1 flex-col min-h-screen p-4 bg-gradient-to-br from-gray-50 via-blue-50 to-gray-100 pb-8",children:[e.jsxs(C.div,{className:"space-y-6",initial:"hidden",animate:"visible",variants:Ve,children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 px-2",children:[e.jsx(ne,{heading:"KYC Verifications",icon:e.jsx(L,{className:"w-9 h-9 text-white animate-pulse"}),color:"bg-brand-aqua shadow-brand-aqua/30",subheading:"Manage user identity documents."}),e.jsxs(p,{variant:"secondary",className:"bg-brand-aqua/20 border border-brand-aqua text-slate-800 font-semibold gap-2 h-11 px-4 shadow-sm shadow-neutral-400",children:[o?.total||0," Total Requests"]})]}),e.jsx(qe,{columns:O,data:r||[],rowCount:o?.total||0,isLoading:s,pagination:b,onPaginationChange:j,globalFilter:N,setGlobalFilter:i=>{t(i),j(d=>({...d,pageIndex:0}))},searchPlaceholder:"Search by nickname, email...",filters:{statusFilter:u,setStatusFilter:i=>{h(i),j(d=>({...d,pageIndex:0}))},sortBy:g,setSortBy:i=>{v(i),j(d=>({...d,pageIndex:0}))}}})]}),e.jsx(Re,{config:l,onClose:()=>w({...l,open:!1})}),e.jsx(ze,{isOpen:a.isOpen,onClose:()=>c({...a,isOpen:!1}),onConfirm:U,title:a.action==="approve"?"Approve KYC?":"Reject KYC?",message:a.action==="approve"?`Are you sure you want to approve ${a.nickname}? This will verify their profile across the platform.`:`Are you sure you want to reject ${a.nickname}? They will need to re-upload their documents.`,confirmText:a.action==="approve"?"Approve User":"Reject User",type:a.action==="approve"?"success":"danger"})]})}export{la as default};
