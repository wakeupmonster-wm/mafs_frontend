import{c as P,i as N,A as v,r as i,cG as y,j as s,C,m as S,n as k,o as E,p as M,H as m,al as A,E as I,cH as T,N as h}from"./index-Cah9GgNi.js";import{L as x}from"./index-657d2hlm.js";import{I as V}from"./IconLock-Ijm8vznG.js";import{C as q}from"./circle-alert-CnaEjTQV.js";import{I as z}from"./IconEye-Br5ZhM_f.js";const U=[["path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828",key:"svg-0"}],["path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}]],Z=P("outline","eye-off","EyeOff",U);function R(){const n=N(),{loading:u,passwordSuccess:w}=v(e=>e.account),[t,g]=i.useState({current:!1,new:!1,confirm:!1}),c=e=>{g(r=>({...r,[e]:!r[e]}))},[a,o]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),f=async e=>{if(e.preventDefault(),a.newPassword===a.confirmPassword)try{const r=await n(T({currentPassword:a.currentPassword,newPassword:a.newPassword})).unwrap();h.success(r.message||"Success",{description:r.description}),o({currentPassword:"",newPassword:"",confirmPassword:""})}catch(r){h.error(r||"Failed to update password")}};i.useEffect(()=>{w&&(o({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>n(y()),5e3))},[w,n]);const l=(e=>{if(!e)return{score:0,label:"",color:""};let r=0;return e.length>6&&r++,e.length>10&&r++,/[A-Z]/.test(e)&&r++,/[0-9]/.test(e)&&r++,/[^A-Za-z0-9]/.test(e)&&r++,{score:r,...[{label:"Very Weak",color:"bg-alerts-error"},{label:"Weak",color:"bg-alerts-error"},{label:"Fair",color:"bg-alerts-warning"},{label:"Strong",color:"bg-alerts-success"},{label:"Very Strong",color:"bg-alerts-success"}][Math.min(r-1,4)]}})(a.newPassword),b=a.confirmPassword&&a.newPassword===a.confirmPassword,p=a.confirmPassword&&a.newPassword!==a.confirmPassword,d=({isVisible:e,onToggle:r})=>s.jsx("button",{type:"button",onClick:r,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors p-1",children:e?s.jsx(Z,{size:20}):s.jsx(z,{size:20})}),j=[{label:"Min. 8 characters",pass:a.newPassword.length>8},{label:"Uppercase letter",pass:/[A-Z]/.test(a.newPassword)},{label:"Number",pass:/[0-9]/.test(a.newPassword)},{label:"Special symbol",pass:/[^A-Za-z0-9]/.test(a.newPassword)}];return s.jsx("div",{className:"min-h-screen",children:s.jsxs(C,{className:"max-w-6xl mx-auto mt-10 px-1 lg:px-2 py-6 border-none shadow-xl bg-white/80 backdrop-blur-md overflow-hidden font-jakarta",children:[s.jsx(S,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-brand-aqua/20 rounded-xl text-brand-aqua shadow-inner",children:s.jsx(V,{size:28})}),s.jsxs("div",{children:[s.jsx(k,{className:"text-2xl font-bold tracking-tight",children:"Security Credentials"}),s.jsx(E,{className:"text-slate-500 font-medium",children:"Update your password to keep your admin account secure."})]})]})}),s.jsx(M,{className:"space-y-6 pt-6",children:s.jsxs("form",{onSubmit:f,className:"grid gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{className:"text-sm text-slate-700 font-bold ml-1",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{type:t.current?"text":"password",className:"h-12 border-slate-200 bg-slate-50/50 focus:bg-white pr-12 rounded-xl",value:a.currentPassword,onChange:e=>o({...a,currentPassword:e.target.value}),placeholder:"••••••••"}),s.jsx(d,{isVisible:t.current,onToggle:()=>c("current")})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{className:"text-sm text-slate-700 font-bold ml-1",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{type:t.new?"text":"password",className:"h-12 border-slate-200 rounded-xl pr-12",value:a.newPassword,onChange:e=>o({...a,newPassword:e.target.value})}),s.jsx(d,{isVisible:t.new,onToggle:()=>c("new")})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{className:"text-sm text-slate-700 font-bold ml-1",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{type:t.confirm?"text":"password",className:`h-12 border-slate-200 rounded-xl pr-12 transition-all ${b?"border-success/50 bg-success/5":p?"border-destructive/50 bg-destructive/5":"border-border"}`,value:a.confirmPassword,onChange:e=>o({...a,confirmPassword:e.target.value})}),s.jsx(d,{isVisible:t.confirm,onToggle:()=>c("confirm")})]}),p&&s.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[s.jsx(q,{className:"w-3 h-3"})," Passwords do not match"]})]})]}),a.newPassword&&s.jsxs("div",{className:"space-y-3 px-1 animate-in fade-in slide-in-from-top-1",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Security Strength"}),s.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${l.color?.replace("bg-","text-")||"text-muted-foreground"}`,children:l.label})]}),s.jsx("div",{className:"flex gap-1.5 h-1.5",children:[1,2,3,4,5].map(e=>s.jsx("div",{className:`h-full flex-1 rounded-full transition-all duration-500 ${e<=l.score?l.color:"bg-secondary"}`},e))}),s.jsx("ul",{className:"grid grid-cols-1 gap-1.5 pt-1",children:j.map(e=>s.jsxs("li",{className:`flex items-center gap-2 text-xs font-medium transition-colors ${e.pass?"text-success":"text-muted-foreground"}`,children:[s.jsx(A,{className:"w-3 h-3",strokeWidth:3}),e.label]},e.label))})]}),s.jsx(I,{disabled:u||a.newPassword!==a.confirmPassword||!a.newPassword,className:"h-14 bg-brand-aqua/20 hover:bg-brand-aqua/60 border border-brand-aqua text-slate-800 shadow-sm shadow-neutral-400 transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed",children:u?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-4 w-4 border-2 border-primary-foreground/30 border-t-primary-foreground animate-spin rounded-full"}),"Updating..."]}):"Update Password"})]})})]})})}export{R as default};
